<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูููุฏ ูุตู ุงูููุชุฌ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูููุฏ ูุตู ุงูููุชุฌุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9O8q+3MpyiAR6csYl1zZ+HjS1K4fXJqFv70Nn/gM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            direction: rtl; /* ูุถูุงู ุงูุงุชุฌุงู ูู ุงููููู ูููุณุงุฑ ููุนุฑุจูุฉ */
            text-align: right; /* ููุญุงุฐุงุฉ ุงููุต ูููููู */
        }
        .container {
            max-width: 900px;
            margin-top: 50px;
            margin-bottom: 50px;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
        .form-label {
            font-weight: bold;
        }
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }
        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }
        .btn-success {
            background-color: #28a745;
            border-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
            border-color: #218838;
        }
        .btn-info {
            background-color: #17a2b8;
            border-color: #17a2b8;
        }
        .btn-info:hover {
            background-color: #138496;
            border-color: #138496;
        }
        .description-box {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            padding: 15px;
            border-radius: 5px;
            min-height: 150px;
            white-space: pre-wrap; /* ููุญูุงุธ ุนูู ุงูุชูุณูู ูุงููุณุงูุงุช */
            word-wrap: break-word; /* ููุณุฑ ุงููููุงุช ุงูุทูููุฉ */
        }
        .history-item {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }
        .history-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <body class="bg-light">
    <div class="container">
        <h1 class="mb-4 text-center text-primary">ูููุฏ ูุตู ุงูููุชุฌุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ๐</h1>
        <p class="lead text-center mb-5">ูู ุจุชูููุฏ ุฃูุตุงู ููุชุฌุงุช ุฌุฐุงุจุฉ ูููุญุณูุฉ ููุญุฑูุงุช ุงูุจุญุซ ูู ูุญุธุงุช!</p>

        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-magic"></i> ุชูููุฏ ูุตู ุฌุฏูุฏ</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="product_title" class="form-label">ุนููุงู ุงูููุชุฌ:</label>
                    <input type="text" class="form-control" id="product_title" placeholder="ูุซุงู: ูุงุชู ุฐูู ูุงุฆูุ ุญููุจุฉ ุณูุฑ ุฐููุฉ" required>
                </div>
                <div class="mb-3">
                    <label for="key_features" class="form-label">ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ (ุงูุตู ุจูููุง ุจูุงุตูุฉ):</label>
                    <textarea class="form-control" id="key_features" rows="3" placeholder="ูุซุงู: ุดุงุดุฉ OLEDุ ุจุทุงุฑูุฉ ุชุฏูู 24 ุณุงุนุฉุ ูุงููุฑุง 108 ููุฌุงุจูุณู" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="seo_keywords" class="form-label">ุงููููุงุช ุงูููุชุงุญูุฉ ุงููุณุชูุฏูุฉ (ุงูุตู ุจูููุง ุจูุงุตูุฉ):</label>
                    <input type="text" class="form-control" id="seo_keywords" placeholder="ูุซุงู: ุฃูุถู ูุงุชู 2025ุ ุดูุทุฉ ุณูุฑ ูุชููุฉุ ูุตู ููุชุฌุงุช" required>
                </div>
                <div class="mb-3">
                    <label for="target_audience" class="form-label">ุงูุฌูููุฑ ุงููุณุชูุฏู:</label>
                    <input type="text" class="form-control" id="target_audience" placeholder="ูุซุงู: ุงูุดุจุงุจ ูุญุจู ุงูุชูููููุฌูุงุ ุงููุณุงูุฑูู ุงูุฏุงุฆูููุ ุงูุฃููุงุช ุงูุฌุฏุฏ">
                    <small class="form-text text-muted">ููู ูุฐุง ุงูููุชุฌุ ูุฐุง ูุณุงุนุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุนูู ุชุฎุตูุต ุงููุตู.</small>
                </div>
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label for="tone" class="form-label">ุงููุจุฑุฉ:</label>
                        <select class="form-select" id="tone">
                            <option value="marketing" selected>ุชุณููููุฉ ูููุนุฉ</option>
                            <option value="friendly">ูุฏูุฏุฉ ูุบูุฑ ุฑุณููุฉ</option>
                            <option value="formal">ุฑุณููุฉ ูููููุฉ</option>
                            <option value="luxury">ูุงุฎุฑุฉ ูุญุตุฑูุฉ</option>
                            <option value="humorous">ููุงููุฉ ููุฑุญุฉ</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="length" class="form-label">ุงูุทูู:</label>
                        <select class="form-select" id="length">
                            <option value="short">ูุตูุฑ ุฌุฏูุง (ุญุชู 40 ูููุฉ)</option>
                            <option value="medium" selected>ูุชูุณุท (100-200 ูููุฉ)</option>
                            <option value="long">ุทููู ูููุตู (250-400 ูููุฉ)</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="language" class="form-label">ุงููุบุฉ:</label>
                        <select class="form-select" id="language">
                            <option value="arabic" selected>ุงูุนุฑุจูุฉ</option>
                            <option value="english">English</option>
                            <option value="spanish">Espaรฑol</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn btn-primary w-100 mb-3" onclick="generateDescription()"><i class="fas fa-cogs"></i> ุชูููุฏ ุงููุตู</button>

                <div id="loading" class="text-center text-info mb-3" style="display:none;">
                    <div class="spinner-border text-info" role="status">
                        <span class="visually-hidden">ุฌุงุฑู ุงูุชูููุฏ...</span>
                    </div>
                    <p>ุฌุงุฑู ุชูููุฏ ุงููุตูุ ูุฏ ูุณุชุบุฑู ุงูุฃูุฑ ุจุถุน ุซูุงูู...</p>
                </div>
                
                <div id="error_message" class="alert alert-danger" style="display:none;"></div>

                <div class="mb-3">
                    <label for="description_output" class="form-label">ุงููุตู ุงูููููุฏ:</label>
                    <div id="description_output" class="description-box"></div>
                </div>
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button type="button" class="btn btn-success me-md-2" onclick="saveDescription()" id="save_btn" disabled><i class="fas fa-save"></i> ุญูุธ ุงููุตู</button>
                    <button type="button" class="btn btn-info" onclick="copyDescription()" id="copy_btn" disabled><i class="fas fa-copy"></i> ูุณุฎ ุงููุตู</button>
                </div>
            </div>
        </div>

        <div class="card shadow-sm">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-history"></i> ุณุฌู ุงูุฃูุตุงู ุงููุญููุธุฉ</h5>
            </div>
            <div class="card-body">
                <button type="button" class="btn btn-danger mb-3" onclick="clearHistory()"><i class="fas fa-trash-alt"></i> ูุณุญ ุงูุณุฌู</button>
                <div id="history_list">
                    <p class="text-muted text-center" id="no_history_message">ูุง ุชูุฌุฏ ุฃูุตุงู ูุญููุธุฉ ุจุนุฏ.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIh7prXmC3lHTB8tQ" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadHistory();
        });

        async function generateDescription() {
            const product_title = document.getElementById('product_title').value;
            const key_features = document.getElementById('key_features').value;
            const seo_keywords = document.getElementById('seo_keywords').value;
            const tone = document.getElementById('tone').value;
            const length = document.getElementById('length').value;
            const language = document.getElementById('language').value;
            const target_audience = document.getElementById('target_audience').value; // ุฌูุจ ุงูุฌูููุฑ ุงููุณุชูุฏู

            const loadingDiv = document.getElementById('loading');
            const errorMessageDiv = document.getElementById('error_message');
            const descriptionOutput = document.getElementById('description_output');
            const saveBtn = document.getElementById('save_btn');
            const copyBtn = document.getElementById('copy_btn');

            errorMessageDiv.style.display = 'none';
            loadingDiv.style.display = 'block';
            descriptionOutput.textContent = ''; // ูุณุญ ุงููุตู ุงูุณุงุจู
            saveBtn.disabled = true;
            copyBtn.disabled = true;

            try {
                const response = await fetch('/generate-description', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        product_title,
                        key_features,
                        seo_keywords,
                        tone,
                        length,
                        language,
                        target_audience // ุฅุฑุณุงู ุงูุฌูููุฑ ุงููุณุชูุฏู ุฅูู ุงูุฎุงุฏู
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    descriptionOutput.textContent = data.description;
                    saveBtn.disabled = false;
                    copyBtn.disabled = false;
                } else {
                    errorMessageDiv.textContent = data.error;
                    errorMessageDiv.style.display = 'block';
                }
            } catch (error) {
                errorMessageDiv.textContent = 'ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน: ' + error.message;
                errorMessageDiv.style.display = 'block';
            } finally {
                loadingDiv.style.display = 'none';
            }
        }

        async function saveDescription() {
            const descriptionText = document.getElementById('description_output').textContent;
            if (!descriptionText) {
                alert('ูุง ููุฌุฏ ูุตู ูุญูุธู!');
                return;
            }

            const product_title = document.getElementById('product_title').value;
            const key_features = document.getElementById('key_features').value;
            const seo_keywords = document.getElementById('seo_keywords').value;
            const tone = document.getElementById('tone').value;
            const length = document.getElementById('length').value;
            const language = document.getElementById('language').value;
            const target_audience = document.getElementById('target_audience').value; // ุฌูุจ ุงูุฌูููุฑ ุงููุณุชูุฏู ููุญูุธ

            try {
                const response = await fetch('/save-description', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        description: descriptionText,
                        product_title,
                        key_features,
                        seo_keywords,
                        tone,
                        length,
                        language,
                        target_audience // ุญูุธ ุงูุฌูููุฑ ุงููุณุชูุฏู
                    })
                });

                const data = await response.json();
                if (response.ok) {
                    alert(data.message);
                    loadHistory(); // ุชุญุฏูุซ ุงูุณุฌู ุจุนุฏ ุงูุญูุธ
                } else {
                    alert('ุฎุทุฃ ูู ุญูุธ ุงููุตู: ' + data.error);
                }
            } catch (error) {
                alert('ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ุงูุญูุธ: ' + error.message);
            }
        }

        function copyDescription() {
            const descriptionText = document.getElementById('description_output').textContent;
            if (descriptionText) {
                navigator.clipboard.writeText(descriptionText).then(() => {
                    alert('ุชู ูุณุฎ ุงููุตู ุจูุฌุงุญ!');
                }).catch(err => {
                    alert('ูุดู ูุณุฎ ุงููุตู: ' + err);
                });
            } else {
                alert('ูุง ููุฌุฏ ูุตู ููุณุฎู!');
            }
        }

        async function loadHistory() {
            const historyList = document.getElementById('history_list');
            const noHistoryMessage = document.getElementById('no_history_message');
            historyList.innerHTML = ''; // ูุณุญ ุงูุณุฌู ุงูุญุงูู

            try {
                const response = await fetch('/get-history');
                const data = await response.json();

                if (response.ok && data.history.length > 0) {
                    noHistoryMessage.style.display = 'none';
                    data.history.reverse().forEach(item => { // ุนุฑุถ ุงูุฃุญุฏุซ ุฃููุงู
                        const historyItemDiv = document.createElement('div');
                        historyItemDiv.className = 'history-item';
                        historyItemDiv.innerHTML = `
                            <h6>${item.product_title} <span class="badge bg-secondary">${item.timestamp}</span></h6>
                            <p><strong>ุงูููุฒุงุช:</strong> ${item.key_features}</p>
                            <p><strong>ุงููููุงุช ุงูููุชุงุญูุฉ:</strong> ${item.seo_keywords}</p>
                            <p><strong>ุงููุจุฑุฉ:</strong> ${item.tone} | <strong>ุงูุทูู:</strong> ${item.length} | <strong>ุงููุบุฉ:</strong> ${item.language}</p>
                            ${item.target_audience ? `<p><strong>ุงูุฌูููุฑ ุงููุณุชูุฏู:</strong> ${item.target_audience}</p>` : ''}
                            <p><strong>ุงููุตู:</strong></p>
                            <div class="description-box">${item.description}</div>
                            <button type="button" class="btn btn-sm btn-outline-info mt-2" onclick="copyTextToClipboard('${item.description.replace(/'/g, "\\'")}')"><i class="fas fa-copy"></i> ูุณุฎ</button>
                        `;
                        historyList.appendChild(historyItemDiv);
                    });
                } else {
                    noHistoryMessage.style.display = 'block';
                }
            } catch (error) {
                historyList.innerHTML = `<p class="text-danger">ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุณุฌู: ${error.message}</p>`;
                noHistoryMessage.style.display = 'none';
            }
        }

        async function clearHistory() {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ูุณุญ ูู ุงูุฃูุตุงู ุงููุญููุธุฉุ')) {
                try {
                    const response = await fetch('/clear-history', {
                        method: 'POST'
                    });
                    const data = await response.json();
                    if (response.ok) {
                        alert(data.message);
                        loadHistory(); // ุชุญุฏูุซ ุงูุณุฌู
                    } else {
                        alert('ุฎุทุฃ ูู ูุณุญ ุงูุณุฌู: ' + data.error);
                    }
                } catch (error) {
                    alert('ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ูุณุญ ุงูุณุฌู: ' + error.message);
                }
            }
        }
        // ุฏุงูุฉ ูุณุงุนุฏุฉ ููุณุฎ ุงููุต ูู ุณุฌู ุงูุฃูุตุงู
        function copyTextToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ุชู ูุณุฎ ุงููุต ุจูุฌุงุญ!');
            }).catch(err => {
                alert('ูุดู ูุณุฎ ุงููุต: ' + err);
            });
        }
    </script>
</body>
    </body>
</html>